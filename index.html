<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ØªØ¹Ù„Ù… Ø­Ù„ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª - Ù„Ø¹Ø¨Ø© Ø¯Ø±Ø§Ø¬ÙˆÙ† Ø¨ÙˆÙƒØ³</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f0f8ff;
      text-align: center;
      padding: 20px;
      margin: 0;
      direction: rtl;
    }
    h1 {
      color: #2c3e50;
    }
    .game-container {
      max-width: 600px;
      margin: 20px auto;
      padding: 20px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    .level {
      font-size: 1.2em;
      color: #e67e22;
      margin-bottom: 10px;
    }
    .equation {
      font-size: 2em;
      margin: 20px 0;
      padding: 15px;
      background: #e8f4fc;
      border-radius: 10px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
    }
    .side {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    .token {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .token:hover {
      transform: scale(1.1);
    }
    .btn {
      margin: 10px;
      padding: 10px 20px;
      font-size: 1em;
      background: #3498db;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    .btn:hover {
      background: #2980b9;
    }
    .feedback {
      margin: 15px 0;
      font-weight: bold;
      min-height: 24px;
    }
    .hidden {
      display: none;
    }
    .win-screen {
      font-size: 1.5em;
      color: #27ae60;
    }
    .hint {
      color: #7f8c8d;
      font-size: 0.9em;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div class="game-container">
    <h1>ğŸ‰ Ù„Ø¹Ø¨Ø© ØªØ¹Ù„Ù… Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª</h1>
    <p>Ø§Ù‡Ø¯Ù Ø¥Ù„Ù‰ Ø¬Ø¹Ù„ Ø§Ù„Ø·Ø±ÙÙŠÙ† Ù…ØªØ³Ø§ÙˆÙŠÙŠÙ† Ù…Ø¹ ØªØ±Ùƒ <strong>x</strong> ÙˆØ­Ø¯Ù‡Ø§!</p>

    <div class="level">Ø§Ù„Ù…Ø³ØªÙˆÙ‰: <span id="level">1</span></div>
    <div class="equation">
      <div class="side" id="left"></div>
      <span>=</span>
      <div class="side" id="right"></div>
    </div>

    <div class="feedback" id="feedback"></div>
    <button class="btn" id="next-btn" onclick="nextLevel()">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ</button>
    <button class="btn" id="reset-btn" onclick="resetLevel()">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©</button>

    <div class="hint" id="hint"></div>
  </div>

  <script>
    let currentLevel = 1;
    const totalLevels = 8;
    const levels = [
      // Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1: ØµÙˆØ± (ÙƒØ±Ø§Øª Ø²Ø±Ù‚Ø§Ø¡ ÙˆØ­Ù…Ø±Ø§Ø¡ ØªÙ„ØºÙŠ Ø¨Ø¹Ø¶Ù‡Ø§)
      { left: ['blue', 'red'], right: ['red'], solution: 'blue', type: 'visual' },
      // Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 2: ØµÙˆØ± + Ø±Ù…Ø² x
      { left: ['x', 'blue'], right: ['green', 'green', 'green'], solution: ['green','green'], type: 'visual' },
      // Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 3: Ø£Ø±Ù‚Ø§Ù… Ø¨Ø³ÙŠØ·Ø©
      { left: ['x', 3], right: [7], solution: 4, type: 'number' },
      // Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 4: x - a = b
      { left: ['x', -2], right: [5], solution: 7, type: 'number' },
      // Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 5: a + x = b
      { left: [4, 'x'], right: [9], solution: 5, type: 'number' },
      // Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 6: a - x = b
      { left: [8, '-x'], right: [3], solution: 5, type: 'number' },
      // Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 7: Ø®Ù„ÙŠØ·
      { left: ['x', -5], right: [2], solution: 7, type: 'number' },
      // Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 8: ØªÙ‚ÙŠÙŠÙ… Ù†Ù‡Ø§Ø¦ÙŠ
      { left: [6, 'x'], right: [13], solution: 7, type: 'number' }
    ];

    const colorMap = {
      blue: '#3498db',
      red: '#e74c3c',
      green: '#2ecc71',
      yellow: '#f1c40f'
    };

    const symbolMap = {
      'x': 'ğŸ¦„',
      '-x': 'ğŸ‰',
      blue: 'ğŸ”µ',
      red: 'ğŸ”´',
      green: 'ğŸŸ¢',
      yellow: 'ğŸŸ¡'
    };

    const nextBtn = document.getElementById('next-btn');
    const resetBtn = document.getElementById('reset-btn');
    const feedbackEl = document.getElementById('feedback');
    const hintEl = document.getElementById('hint');

    function initGame() {
      const levelData = levels[currentLevel - 1];
      document.getElementById('level').textContent = currentLevel;
      renderEquation(levelData);
      nextBtn.classList.add('hidden');
      feedbackEl.textContent = '';
      hintEl.textContent = getHint(levelData);
    }

    function renderEquation(levelData) {
      const leftEl = document.getElementById('left');
      const rightEl = document.getElementById('right');
      leftEl.innerHTML = '';
      rightEl.innerHTML = '';

      levelData.left.forEach(item => {
        const token = document.createElement('div');
        token.className = 'token';
        if (levelData.type === 'visual' && typeof item === 'string' && item !== 'x' && item !== '-x') {
          token.style.backgroundColor = colorMap[item];
        } else if (levelData.type === 'visual') {
          token.textContent = symbolMap[item] || item;
        } else {
          token.textContent = item;
        }
        token.onclick = () => handleTokenClick(item, levelData);
        leftEl.appendChild(token);
      });

      levelData.right.forEach(item => {
        const token = document.createElement('div');
        token.className = 'token';
        if (levelData.type === 'visual' && typeof item === 'string' && item !== 'x' && item !== '-x') {
          token.style.backgroundColor = colorMap[item];
        } else if (levelData.type === 'visual') {
          token.textContent = symbolMap[item] || item;
        } else {
          token.textContent = item;
        }
        token.onclick = () => handleTokenClick(item, levelData, true);
        rightEl.appendChild(token);
      });
    }

    function handleTokenClick(item, levelData, isRight = false) {
      if (typeof item === 'string' && (item === 'x' || item === '-x')) {
        feedback("Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø²Ø§Ù„Ø© x Ø¨Ù‡Ø°Ù‡ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø©. ÙÙƒØ± ÙƒÙŠÙ ØªØ¬Ø¹Ù„ x ÙˆØ­Ø¯Ù‡Ø§!");
        return;
      }

      // Ù†Ù‚Ù„ Ø£Ùˆ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¹Ù†ØµØ±
      if (isRight) {
        levelData.right = levelData.right.filter(i => i !== item);
      } else {
        levelData.left = levelData.left.filter(i => i !== item);
      }

      // Ø¥Ø²Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø¢Ø®Ø± (Ù„Ù„ØªÙˆØ§Ø²Ù†)
      if (levelData.type === 'visual') {
        const opposite = getOppositeColor(item);
        const oppIndex = levelData.right.indexOf(opposite);
        if (oppIndex !== -1) {
          levelData.right.splice(oppIndex, 1);
        } else {
          // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ Ù…Ù‚Ø§Ø¨Ù„ØŒ Ù†Ø¶ÙŠÙÙ‡ ÙƒÙ€ "Ø³Ø§Ù„Ø¨"
          levelData.right.push(opposite);
        }
      } else {
        // ÙÙŠ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…: Ù†Ø·Ø±Ø­ Ù†ÙØ³ Ø§Ù„Ù‚ÙŠÙ…Ø© Ù…Ù† Ø§Ù„Ø·Ø±ÙÙŠÙ†
        const value = item === '-x' ? 0 : (typeof item === 'number' ? item : 0);
        if (value !== 0) {
          // Ù†Ø¨Ø­Ø« Ø¹Ù† Ù†ÙØ³ Ø§Ù„Ø±Ù‚Ù… ÙÙŠ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø¢Ø®Ø± ÙˆÙ†Ø­Ø°ÙÙ‡
          const idx = levelData.right.indexOf(value);
          if (idx !== -1) {
            levelData.right.splice(idx, 1);
          } else {
            levelData.right.push(-value);
          }
        }
      }

      renderEquation(levelData);
      checkWin(levelData);
    }

    function getOppositeColor(color) {
      const opposites = { blue: 'red', red: 'blue', green: 'yellow', yellow: 'green' };
      return opposites[color] || color;
    }

    function checkWin(levelData) {
      const left = levelData.left;
      const right = levelData.right;

      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù†ØµØ±
      if (left.length === 1 && left[0] === 'x' && right.length === 1 && right[0] === levelData.solution) {
        feedback("ğŸ‰ Ø£Ø­Ø³Ù†Øª! Ù‡Ø°Ù‡ Ù‡ÙŠ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©!", 'win');
        nextBtn.classList.remove('hidden');
      } else if (left.length === 1 && left[0] === '-x' && right.length === 1 && right[0] === -levelData.solution) {
        feedback("ğŸ‰ Ù†Ø§Ø¬Ø­! Ù„ÙƒÙ† ØªØ°ÙƒÙ‘Ø±: -x = -a ØªØ¹Ù†ÙŠ Ø£Ù† x = a", 'win');
        nextBtn.classList.remove('hidden');
      } else if (left.length === 0 && right.length === 0) {
        feedback("â— Ø£Ø²Ù„Øª ÙƒÙ„ Ø´ÙŠØ¡! ØªØ°ÙƒÙ‘Ø± Ø£Ù† x ÙŠØ¬Ø¨ Ø£Ù† ØªØ¨Ù‚Ù‰ ÙˆØ­Ø¯Ù‡Ø§ ÙÙŠ Ø§Ù„ÙŠØ³Ø§Ø±.");
      } else if (left.length === 1 && left[0] === 'x') {
        const val = right[0];
        if (val === levelData.solution) {
          feedback("ğŸ‰ Ù†Ø§Ø¬Ø­! x = " + val, 'win');
          nextBtn.classList.remove('hidden');
        } else {
          feedback("ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹! x = " + val + " Ù„ÙƒÙ† Ø§Ù„Ø¬ÙˆØ§Ø¨ Ø§Ù„ØµØ­ÙŠØ­ Ù‡Ùˆ " + levelData.solution);
        }
      }
    }

    function feedback(msg, type = 'normal') {
      feedbackEl.textContent = msg;
      if (type === 'win') {
        feedbackEl.style.color = '#27ae60';
      } else {
        feedbackEl.style.color = '#e74c3c';
      }
    }

    function getHint(levelData) {
      switch (currentLevel) {
        case 1:
          return "Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…ØªÙ‚Ø§Ø¨Ù„Ø© (Ø§Ù„Ø£Ø­Ù…Ø± Ù…Ø¹ Ø§Ù„Ø£Ø²Ø±Ù‚) Ù„Ø¥Ø²Ø§Ù„ØªÙ‡Ø§ Ù…Ù† Ø§Ù„Ø·Ø±ÙÙŠÙ†.";
        case 2:
          return "Ù‡Ø¯ÙÙƒ Ù‡Ùˆ ØªØ±Ùƒ Ø§Ù„ÙˆØ­Ø´ (x) ÙˆØ­Ø¯Ù‡ ÙÙŠ Ø§Ù„ÙŠØ³Ø§Ø±.";
        case 3:
          return "Ø¥Ø°Ø§ ÙƒØ§Ù† x + 3 = 7ØŒ ÙÙƒÙ… ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† xØŸ";
        case 4:
          return "x - 2 = 5 ØªØ¹Ù†ÙŠ Ø£Ù† x = 5 + 2.";
        default:
          return "Ø§Ø­Ø°Ù Ø§Ù„Ø¹Ø¯Ø¯ Ø¨Ø¬Ø§Ù†Ø¨ x Ù…Ù† Ø§Ù„Ø·Ø±ÙÙŠÙ† Ù„ØªØ­ØµÙ„ Ø¹Ù„Ù‰ x = ...";
      }
    }

    function nextLevel() {
      if (currentLevel < totalLevels) {
        currentLevel++;
        initGame();
      } else {
        document.getElementById('left').innerHTML = "ğŸ‰";
        document.getElementById('right').innerHTML = "ğŸ‘";
        feedback("Ù„Ù‚Ø¯ Ø£ØªÙ‚Ù†Øª Ø­Ù„ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ù…Ù† Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰! Ø£Ø­Ø³Ù†Øª!", 'win');
        nextBtn.disabled = true;
        nextBtn.textContent = "Ø§ÙƒØªÙ…Ù„!";
      }
    }

    function resetLevel() {
      const levelData = JSON.parse(JSON.stringify(levels[currentLevel - 1]));
      levels[currentLevel - 1] = levelData;
      initGame();
    }

    // Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©
    initGame();
  </script>
</body>
</html>
